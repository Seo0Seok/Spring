<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.mapper.MainMapper">	
	<select id="selectGetItemList" parameterType="hashmap" resultType="com.example.demo.model.Product">
		SELECT 
		    t.board_idx
		    , b_title
		    , b_content
		    , u_nickname
		    , u_address
		    , p_price
		    , GROUP_CONCAT(img SEPARATOR ';') as img
		FROM
		    t2_product t
		LEFT OUTER JOIN t2_image i on t.board_idx = i.board_idx 
		WHERE
		    t.board_idx = i.board_idx
		GROUP BY t.board_idx 
		ORDER BY
			 t.board_idx DESC
	</select>
	
	<select id="searchArea" parameterType="hashmap" resultType="com.example.demo.model.Product">	
		SELECT 
			t.board_idx
			, b_title
			, b_content
			, u_nickname
			, u_address
			, p_price
			, GROUP_CONCAT(img SEPARATOR ';') as img
		FROM 
			t2_product t
		LEFT OUTER JOIN 
			t2_image i on t.board_idx = i.board_idx 
		WHERE
			 t.board_idx = i.board_idx AND u_address LIKE CONCAT('%', #{keyword}, '%')   
		GROUP BY 
			t.board_idx
		ORDER BY
			 t.board_idx DESC
	</select>
	
	<select id="searchTitle" parameterType="hashmap" resultType="com.example.demo.model.Product">	
		SELECT 
			t.board_idx
			, b_title
			, b_content
			, u_nickname
			, u_address
			, p_price
			, GROUP_CONCAT(img SEPARATOR ';') as img
		FROM 
			t2_product t
		LEFT OUTER JOIN 
			t2_image i on t.board_idx = i.board_idx 
		WHERE
			 t.board_idx = i.board_idx AND b_title LIKE CONCAT('%', #{keyword}, '%')   
		GROUP BY 
			t.board_idx
		ORDER BY
			 t.board_idx DESC
	</select>
	
		<select id="selectGetMyItemList" parameterType="hashmap" resultType="com.example.demo.model.Product">
		SELECT 
		    t.board_idx
		    , b_title
		    , b_content
		    , u_nickname
		    , u_address
		    , p_price
		    , GROUP_CONCAT(img SEPARATOR ';') as img
		FROM
		    t2_product t
		LEFT OUTER JOIN t2_image i on t.board_idx = i.board_idx 
		WHERE
		    u_nickname = #{userNickName}
		GROUP BY t.board_idx 
		ORDER BY
			 t.board_idx DESC
	</select>
	
	
</mapper>